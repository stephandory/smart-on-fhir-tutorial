<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>DoryGo-Dev-SMART-App</title>
  </head>
  <body>
    <div id="errors"></div>
    <div id="loading" class="spinner">
      <p>Loading...</p>
    </div>

    <!-- FHIR Client JS Library -->
    <script src="./lib/js/fhir-client-v0.1.12.js"></script>
    <script>
      // Extrahiere den Access Token und leite weiter
      FHIR.oauth2.ready()
        .then(client => {
          const accessToken = client.state.tokenResponse.access_token;
          console.log("Access Token:", accessToken);

          // Weiterleitung zur FlutterFlow-App mit Access Token
          window.location.href = `https://dorygo-us-dev.flutterflow.app?code=${accessToken}`;
        })
        .catch(error => {
          console.error("Fehler bei der Authentifizierung:", error);
          document.getElementById("loading").innerText = "Failed to authenticate.";
        });
    </script>
  </body>
</html>
